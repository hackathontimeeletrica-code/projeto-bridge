<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Onda Dente de Serra - Projeto Bridge</title>
    
    <style>
        :root {
            --cor-fundo: #121212; --cor-container: #1e1e1e; --cor-texto: #e0e0e0;
            --cor-destaque: #00aaff; --cor-sombra: rgba(0, 0, 0, 0.4);
            --cor-barra-preenchida: #00aaff; /* Cor do preenchimento da barra de progresso */
            --cor-barra-vazia: #555;      /* Cor da parte não preenchida da barra */
            --cor-thumb: #ffffff;         /* Cor do "círculo" que arrasta na barra */
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--cor-fundo);
            color: var(--cor-texto);
        }
        
        /* Layout Responsivo */
        .container {
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
            text-align: center;
        }
        h1 { font-size: 2.2rem; color: white; margin-bottom: 20px; }
        p { line-height: 1.7; margin-bottom: 25px; }
        
        /* Esconde o elemento de áudio padrão do navegador */
        #audio-da-pagina {
            display: none; 
        }
        
        .gif-container img {
            max-width: 100%;
            border-radius: 10px;
            border: 1px solid #333;
        }
        /* Classe para girar GIF se necessário (remova se o seu GIF estiver correto) */
        .gif-invertido { transform: rotate(180deg); } 
        
        .voltar { display: inline-block; margin-top: 40px; color: var(--cor-destaque); text-decoration: none; font-weight: bold; }
        .voltar:hover { text-decoration: underline; }

        /* =================================================== */
        /* INÍCIO DO NOVO CSS (PLAYER ACESSÍVEL)             */
        /* =================================================== */

        /* Classe para esconder visualmente mas manter para leitores de tela */
        .sr-only {
            position: absolute;
            left: -9999px;
            top: auto;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        /* Link "Pular" para acessibilidade */
        .skip-link {
            position: absolute;
            left: -9999px;
            top: auto;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
        .skip-link:focus {
            left: 10px;
            top: 10px;
            width: auto;
            height: auto;
            padding: 10px;
            background-color: var(--cor-container);
            color: var(--cor-texto);
            z-index: 1000;
            text-decoration: none;
            font-weight: bold;
            border: 2px solid var(--cor-destaque);
        }

        /* Container do botão player */
        .player-controls {
            width: 100%;
            max-width: 600px;
            padding: 10px 0 20px 0; 
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #botao-player-principal {
            width: 100%;           
            min-height: 70px;      
            padding: 15px;         
            font-size: 1.5rem;     
            font-weight: bold;     
            color: var(--cor-fundo);  
            background-color: var(--cor-destaque);
            border: none;          
            border-radius: 8px;    
            cursor: pointer;       
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: outline-offset 0.1s ease;
            margin-bottom: 15px; /* Espaço para a barra de progresso */
        }

        #botao-player-principal:focus {
            outline: 4px solid var(--cor-destaque);
            outline-offset: 4px;
        }

        /* ESTILOS DA LINHA DO TEMPO (Progress Bar) */
        .progress-container {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--cor-texto);
            font-size: 0.9rem;
            margin-bottom: 10px; 
        }

        #progress-bar {
            flex-grow: 1; 
            -webkit-appearance: none; 
            appearance: none;
            height: 12px; 
            border-radius: 6px; 
            background: var(--cor-barra-vazia);
            outline: none;
            cursor: pointer;
            transition: opacity .2s; 
        }

        #progress-bar:hover {
            opacity: 0.8;
        }

        /* Estilo do "thumb" (o círculo que arrasta) */
        #progress-bar::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px; 
            height: 20px;
            border-radius: 50%; 
            background: var(--cor-thumb);
            cursor: pointer;
            margin-top: -4px; 
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }

        #progress-bar::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--cor-thumb);
            cursor: pointer;
        }

        /* Estilo da parte preenchida da barra (para navegadores WebKit) */
        /* Usamos uma variável CSS (--progress-value) para controlar o preenchimento via JS */
        #progress-bar::-webkit-slider-runnable-track {
            background: linear-gradient(to right, var(--cor-barra-preenchida) var(--progress-value, 0%), var(--cor-barra-vazia) var(--progress-value, 0%));
            border-radius: 6px;
            height: 12px;
        }
        #progress-bar::-moz-range-track {
             background: linear-gradient(to right, var(--cor-barra-preenchida) var(--progress-value, 0%), var(--cor-barra-vazia) var(--progress-value, 0%));
            border-radius: 6px;
            height: 12px;
        }

        /* ESTILOS DO CONTROLE DE VELOCIDADE */
        .speed-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            width: 100%;
            margin-top: 15px; /* Espaço acima dos botões */
        }
        .speed-btn {
            padding: 8px 12px;
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--cor-destaque);
            background-color: transparent;
            border: 2px solid var(--cor-destaque);
            border-radius: 5px;
            cursor: pointer;
        }
        /* Estilo do botão de velocidade ativo */
        .speed-btn[aria-pressed="true"] {
            background-color: var(--cor-destaque);
            color: var(--cor-fundo);
        }
        
        /* =================================================== */
        /* FIM DO NOVO CSS                                 */
        /* =================================================== */

        /* Regras para telas maiores */
        @media (min-width: 768px) {
            .container {
                width: 90%;
                max-width: 700px; 
                margin: 40px auto;
                border-radius: 12px;
                background-color: var(--cor-container);
                padding: 40px;
                box-shadow: 0 8px 20px var(--cor-sombra);
                border: 1px solid rgba(255, 255, 255, 0.1);
                min-height: auto;
            }
        }
    </style>
</head>
<body>

    <div id="status-anunciador" class="sr-only" aria-live="polite" aria-atomic="true"></div>
    
    <a href="#conteudo-principal" class="skip-link">Pular para o conteúdo principal</a>

    <main class="container" id="conteudo-principal">
        
        <h1>Placa: Onda Dente de Serra</h1>

        <div class="player-controls">
            
            <button id="botao-player-principal" aria-label="Ouvir descrição da onda dente de serra">
                ▶ Ouvir Descrição
            </button>

            <div class="progress-container">
                <span id="current-time">0:00</span>
                <input type="range" id="progress-bar" value="0" min="0" max="100" aria-label="Barra de progresso do áudio">
                <span id="duration-time">0:00</span>
            </div>

            <div class="speed-controls" role="group" aria-label="Controle de velocidade">
                <button class="speed-btn" data-speed="1">1x</button>
                <button class="speed-btn" data-speed="1.5">1.5x</button>
                <button class="speed-btn" data-speed="2">2x</button>
            </div>
        </div>
        
        <div class="gif-container">
            <img class="gif-invertido" src="./gif-dente-de-serra.gif" alt="Animação 3D da placa da onda dente de serra girando">
        </div>

        <div class="sr-only">
            <h3>Descrição da Placa Tátil</h3>
            <p>
                A placa tátil 3D exibe a forma de onda dente de serra. 
                Possui uma linha de base texturizada para representar o eixo do tempo. 
                A onda em si é um relevo alto que sobe linearmente da linha de base até seu pico máximo e, 
                em seguida, cai abruptamente de volta à linha de base, repetindo o ciclo. 
                Inscrições em Braille na parte superior indicam "ONDA DENTE DE SERRA".
                (Substitua este texto pela descrição real da sua placa).
            </p>
        </div>
        
        <audio id="audio-da-pagina">
            <source src="./audio-dente-de-serra.mp3" type="audio/mpeg">
            Seu navegador não suporta o elemento de áudio.
        </audio>
        
        <a href="../" class="voltar">← Voltar para a página inicial</a>
    </main>

    <script>
        // Formata o tempo para MM:SS
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            const paddedSeconds = remainingSeconds < 10 ? '0' + remainingSeconds : remainingSeconds;
            return `${minutes}:${paddedSeconds}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Pegando todos os elementos
            const botaoPlayer = document.getElementById('botao-player-principal');
            const audioPlayer = document.getElementById('audio-da-pagina');
            const progressBar = document.getElementById('progress-bar');
            const currentTimeSpan = document.getElementById('current-time');
            const durationTimeSpan = document.getElementById('duration-time');
            const anunciador = document.getElementById('status-anunciador');
            const speedButtons = document.querySelectorAll('.speed-btn');

            if (botaoPlayer && audioPlayer && progressBar && currentTimeSpan && durationTimeSpan && anunciador && speedButtons.length > 0) {
                
                // === LÓGICA DO BOTÃO PLAY/PAUSE/RESTART ===
                botaoPlayer.addEventListener('click', () => {
                    if (audioPlayer.paused) {
                        audioPlayer.play();
                    } else {
                        audioPlayer.pause();
                    }
                });

                audioPlayer.addEventListener('play', () => {
                    botaoPlayer.innerHTML = '⏸ Pausar Descrição';
                    botaoPlayer.setAttribute('aria-label', 'Pausar descrição');
                    // IDEIA 1: Anuncia a ação
                    anunciador.textContent = 'Áudio iniciado.'; 
                });

                audioPlayer.addEventListener('pause', () => {
                    if (!audioPlayer.ended) {
                        botaoPlayer.innerHTML = '▶ Continuar Descrição';
                        botaoPlayer.setAttribute('aria-label', 'Continuar descrição');
                        // IDEIA 1: Anuncia a ação
                        anunciador.textContent = 'Áudio pausado.';
                    }
                });

                audioPlayer.addEventListener('ended', () => {
                    botaoPlayer.innerHTML = '▶ Reiniciar Descrição';
                    botaoPlayer.setAttribute('aria-label', 'Reiniciar descrição');
                    // IDEIA 1: Anuncia a ação
                    anunciador.textContent = 'Áudio terminado. Pronto para reiniciar.';
                });

                // === LÓGICA DA BARRA DE PROGRESSO ===

                // Atualiza o preenchimento da barra (para o estilo visual)
                const updateProgressFill = () => {
                    const value = (progressBar.value / progressBar.max) * 100 || 0;
                    progressBar.style.setProperty('--progress-value', `${value}%`);
                };

                // Quando o áudio estiver carregado
                audioPlayer.addEventListener('loadedmetadata', () => {
                    const duration = audioPlayer.duration;
                    durationTimeSpan.textContent = formatTime(duration);
                    progressBar.max = duration;
                    updateProgressFill();
                });

                // Atualiza a barra e os tempos enquanto o áudio toca
                audioPlayer.addEventListener('timeupdate', () => {
                    const currentTime = audioPlayer.currentTime;
                    progressBar.value = currentTime;
                    currentTimeSpan.textContent = formatTime(currentTime);
                    
                    // IDEIA 2: Faz a barra "falar" o tempo atual
                    progressBar.setAttribute('aria-valuetext', `Tempo atual: ${formatTime(currentTime)}`);
                    
                    updateProgressFill();
                });

                // Quando o usuário interage com a barra de progresso
                progressBar.addEventListener('input', () => {
                    audioPlayer.currentTime = progressBar.value;
                    
                    // IDEIA 2: Fala o tempo para onde está pulando
                    progressBar.setAttribute('aria-valuetext', `Pular para: ${formatTime(progressBar.value)}`);
                    updateProgressFill();
                });

                // === IDEIA 3: LÓGICA DO CONTROLE DE VELOCIDADE ===
                speedButtons.forEach(button => {
                    // Marcar o botão de 1x como padrão
                    if (button.dataset.speed == "1") {
                        button.setAttribute('aria-pressed', 'true');
                    } else {
                        button.setAttribute('aria-pressed', 'false');
                    }

                    button.addEventListener('click', () => {
                        const newSpeed = parseFloat(button.dataset.speed);
                        audioPlayer.playbackRate = newSpeed;

                        // Atualiza o estado visual/acessível de "pressionado"
                        speedButtons.forEach(btn => btn.setAttribute('aria-pressed', 'false'));
                        button.setAttribute('aria-pressed', 'true');
                        
                        // IDEIA 1: Anuncia a mudança de velocidade
                        anunciador.textContent = `Velocidade definida para ${newSpeed}x.`;
                    });
                });
            }
        });
    </script>
</body>
</html>
